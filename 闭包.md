# 闭包

---

**闭包（closure）**
1. 闭包是由函数和其相关的引用环境组合而成的实体
2. 闭包是词法作用域中的函数和其相关变量的包裹体
3. 执行上下文（代号A）
4. 在执行上下文中创建的函数（代号B）
    当B（函数）执行时，如果访问了A中变量对象中的值，就会产生闭包

---

**闭包与作用域链**
1. 作用域规则在代码编译阶段确定，即在代码书写之后作用域链就已确定
    *作用域链在代码执行时生成*
    *变量查找按照作用域链由内到外的顺序（遵循词法作用域），直到完成查找，若未查询到则报错*
2. 调用栈在代码执行时确定，作用是处理和追踪函数调用

---

**闭包的作用**
1. 可通过闭包访问隐藏在函数作用域内的局部变量
2. 使函数中的变量被保存在内存中不被释放

---

**垃圾回收机制（Garbage Collection）**
1. 执行上下文（execution context）
*函数每调用一次，就会创建一个新的执行上下文*
*函数执行结束，相应的执行上下文销毁*
2. 闭包：使函数中的变量被保存在内存中不被释放
3. 内存声明周期
 *分配内存*
 *使用内存*
 *释放内存*
 4. 垃圾回收方法
 *引用计数*
 *标记-—清除*

---

**内存释放**
1. 全局变量
2. 定时器
3. 对象引用

---

**闭包的常见形式**
1. 以普通函数形式返回
2. 作为对象的方法返回















